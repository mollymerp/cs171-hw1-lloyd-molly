
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CS171 Homework 1</title>

  <style type="text/css">
  /* YOUR CSS */
  </style>
</head>
<body>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script>
  d3.text("unemp_states_us_nov_2013.tsv", function(error,unparsedData){

  	
  	
  var datum = d3.tsv("unemp_states_us_nov_2013.tsv", function(error,dat) {
  													dat.forEach(function(d){
  														d.state=(d.state);
  														d.rank=+d.rank;
  														d.rate = +d.rate;})})
  		columns = datum[0]
        title = (["Unemployment Rates for States","Monthly Rankings","Seasonally Adjusted","Dec. 2013"]);
 console.log(datum);
      
      var table = d3.select("body").append("table"),
      thead = table.append("thead"),
      tbody = table.append("tbody");

console.log(data);
   
  
  var titles = thead.append("tr").append("th")
                    .attr("align","center")
                    .attr("colspan","3")
                    .selectAll("h1")
                    .data(title)
                    .enter()
                    .append("h1")
                    .text(function(d) {return d;});
   
  thead.append("tr")
       .selectAll("td")
       .data(columns)
       .enter()
       .append("td")
       .text(function(col) {return col; })
       .attr("class", function(d,i){return "tcol"+i });


 console.log(data.shift());


      var rows = tbody.selectAll("tr")
      .data(data)
      .enter()
      .append("tr");



             

          rows.style("background-color", function(d,i) {
                                   if (i%2 == 0) {
                                     return "grey";
                                     } else {
                                     return "white";}})  
           .on("mouseover", function(){
                                       d3.select(this).style("background-color","yellow")})
           .on("mouseout", function(d,i) { d3.select(this).style("background-color", function(d1,j) {
                                   if (i%2 === 0) {
                                     return "grey";
                                     } else {
                                     return "white";}})});

      var cells = rows.selectAll("td")
      .data(function(row) {
        return d3.range(Object.keys(row).length).map(function(column, i) {
          return row[Object.keys(row)[i]];
          });
        })
      .enter()
      .append("td")
      .text(function(d) { return d; });

 

     cells.attr("class", function(d,i){return "col" + i;})
           .on("mouseover", function(d,i) 
                          { d3.selectAll("td.col" + i)
                           .style("background-color", "yellow");})

           .on("mouseout", function(d,i)
                    { d3.selectAll("td.col" + i)
                           .style("background-color", null); 
                      rows.style("background-color", function(d1,j) {
                                   if (j%2 == 0) {
                                     return "grey";
                                     } else {
                                     return "white";}});});
   
  
           thead.select("td.tcol2")
                   .on("click", function() 
                   {rows.sort(function(a, b) {return d3.ascending(a[2], b[2]);});
                    rows.style("background-color", function(d1,j) {
                                     if (j%2 == 0) {
                                       return "grey";
                                     } else {
                                       return "white";}});
              
});         


      });
  </script>
</body>
</html>
